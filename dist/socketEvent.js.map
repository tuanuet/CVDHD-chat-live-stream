{"version":3,"sources":["../socketEvent.js"],"names":["ss","require","module","exports","io","of","on","socket","console","log","id","data","cb","join","roomId","err","blob","broadcast","to","emit"],"mappings":";;AAAA,IAAIA,KAAKC,QAAQ,kBAAR,CAAT;;AAEAC,OAAOC,OAAP,GAAiB,UAACC,EAAD,EAAQ;AACvBA,KAAGC,EAAH,CAAM,aAAN,EAAqBC,EAArB,CAAwB,YAAxB,EAAqC,UAACC,MAAD,EAAY;AAC/CC,YAAQC,GAAR,CAAY,oBAAZ,EAAiCF,OAAOG,EAAxC;;AAEAH,WAAOD,EAAP,CAAU,MAAV,EAAiB,UAACK,IAAD,EAAMC,EAAN,EAAa;AAC5BL,aAAOM,IAAP,CAAYF,KAAKG,MAAjB,EAAwB,UAACC,GAAD,EAAS;AAC/B,YAAGA,GAAH,EAAQ,OAAOH,GAAG,KAAH,CAAP;;AAERL,eAAOO,MAAP,GAAgBH,KAAKG,MAArB;AACA,eAAOF,GAAG,IAAH,CAAP;AACD,OALD;AAOD,KARD;AASAL,WAAOD,EAAP,CAAU,WAAV,EAAuB,UAASU,IAAT,EAAe;AACpCR,cAAQC,GAAR,CAAY,mBAAZ,EAAgCO,IAAhC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAT,aAAOU,SAAP,CAAiBC,EAAjB,CAAoBX,OAAOO,MAA3B,EAAmCK,IAAnC,CAAwC,6BAAxC,EAAsEH,IAAtE;AAED,KAbD;AAcD,GA1BD;AA2BD,CA5BD","file":"socketEvent.js","sourcesContent":["var ss = require('socket.io-stream');\n\nmodule.exports = (io) => {\n  io.of('/livestream').on('connection',(socket) => {\n    console.log('Event connection: ',socket.id);\n\n    socket.on('join',(data,cb) => {\n      socket.join(data.roomId,(err) => {\n        if(err) return cb(false);\n\n        socket.roomId = data.roomId;\n        return cb(true);\n      })\n\n    })\n    socket.on('streaming', function(blob) {\n      console.log('Event streaming: ',blob);\n      // let sockets = io.nsps['/livestream'].connected;\n      // for(var i in sockets) {\n      //   //don't send the stream back to the initiator\n      //   if (sockets[i].id != socket.id){\n      //     var socketTo = sockets[i];\n      //     console.log(socketTo.id)\n      //     ss(socketTo).emit('server-broadcast-livestream',stream,data)\n      //   }\n      // }\n      socket.broadcast.to(socket.roomId).emit('server-broadcast-livestream',blob)\n\n    });\n  });\n}\n"]}